## We Can Exploit it for you Wholesale

This blog is going to cover my experiences with a pentesting CTF I completed on a fictional company, Rekall. I really enjoyed this exercise and putting into practice so much of what I have learned. All the way from OSINT to escalating privileges and maintaining persistence on a system. It was also Total Recall themed and chalk full of 90’s nostalgia I love. This was a white box exercise, the scope was well defined and while I did do some OSINT and recon it was on previously identified assets. 

A summary of the project- 
“Rekall Corporation is a fictional company that specializes in offering virtual reality experiences based on images that customers upload. These experiences could include dream vacations, adventures, or even secret missions. Rekall guarantees that these virtual reality experiences will feel real. Rekall is about to go live with their business, and they need penetration testers to find any vulnerabilities within their technical systems. Rekall has a brand new web application and several Windows and Linux servers that manage their businesses. You are tasked with using the offensive security skills that you’ve learned over the last couple of weeks to find any vulnerabilities in Rekall’s technical infrastructure and summarize the appropriate mitigations.”

I started the exercise by testing Rekall’s new web application to ensure its security. I was able to use cross-site scripting in the Memory-Planner section of the web app. There was limited input validation that had been implemented. The field was removing the word script, but I simply had to split the word using “<SCRIPscriptT>alert("hi")</SCRIPscripTt>” to be able to execute commands. I was also able to accomplish local file intrusions in a couple of spots on their site. One file upload was for .jpg files and there was some security around requiring .jpg in the field. However, if we simply called our php file “example.jpg.php” it allowed us to upload a php rather than a jpg. These were all relatively minor, I was able to exploit vulnerabilities but none provided any critical access. 

The next step was to open up Burp Suite and take a look at the traffic. The response and request headers were unencrypted in HTTP, and though we could view some data it did not expose anything sensitive or useful for gaining access. I then opened up the page source for each of the pages and discovered credentials in plain text for one dougquaid with a password of kuato. This particular data exposure was critical as user dougquaid had admin access to a set of networking tools. I was able to use command injections to view the /etc/passwd file on the server which held another username to try and gain access with. The new user was melina and I was able to perform a pretty simple brute force as her password was also melina. These credentials provided different access than dougquaid but the sensitive legal documents found were not accessible. After looking through the page source again, we determined we were able to swap sessions using Burp suite’s Intruder tool and view the sensitive documents. At this point we were unable to further exploit or escalate so I moved on to the next phase of the testing. 

My next task was to evaluate security on Rekall’s network infrastructure. I performed some light OSINT looking up the WHOIS record for rekall.xyz which exposed some minor sensitive data that could easily be removed. I continued my recon by running an nmap scan on the subnet range I was provided which returned 5 hosts that were up (192.168.13.10-15). I continued to scan each host with an aggressive nmap scan to see what further information I could glean. 
